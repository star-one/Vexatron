<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>The Vexatron</title>
    <!-- CSS
         ================================================== -->
    <link rel="stylesheet" href="./css/style.css" />
    <link rel="stylesheet" href="./css/skeleton.css" />
    <link rel="stylesheet" href="./css/layout.css" />
    <link rel="stylesheet" href="./css/wordpress.css" />
    <link rel="stylesheet" href="./css/metro.css" />
    <!-- Mobile Specific Metas
  ================================================== -->
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <!--[if lt IE 9]>
                <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
	 <script src="./js/general.js"></script>
	 <script src="./js/about.js"></script>
  </head>
  <body>
    <div>
      <div id="page" class="hfeed">
        <div id="top-bar">
          <div class="container">
            <div class="sixteen columns">
              <header id="branding" role="banner" style="height: 75px;">
                  <hgroup>
                    <h1 class="screen-reader-text">The Vexatron</h1>
                  </hgroup>
               </header>
            </div>
          </div>
            <div class="container">
              <div class="sixteen columns">
                <nav>
                  <div id="access" role="navigation">
                    <h2 class="assistive-text section-heading">Main menu</h2>
                    <div class="skip-link screen-reader-text">Skip to content</div><?php include './menu.php' ?>
                  </div>
                  <!-- #access -->
                </nav>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- #branding -->
    </div>
    <div class="container">
      <div id="main">
<button onclick="playAud()" type="button">Play</button>
<button onclick="rptAud()" type="button">Force repeat</button> 
<button onclick="stopAud()" type="button">Stop</button> 
<br> 
<audio id="audio1">
  <source src="./vexations.mp3" type="audio/mp3">
  Your browser does not support HTML5 audio.
</audio>
<audio id="audio2">
  <source src="./vexations-001.mp3" type="audio/mp3">
  Your browser does not support HTML5 audio.
</audio>
<audio id="audio3">
  <source src="./vexations-002.mp3" type="audio/mp3">
  Your browser does not support HTML5 audio.
</audio>
<audio id="audio4">
  <source src="./vexations-004.mp3" type="audio/mp3">
  Your browser does not support HTML5 audio.
</audio>
<span style="background: #fff;">Total number of repeats: <span id="theTotalRepeats">5</span> / total time: <span id="theTotalTime">0:8:45</span> minutes.</span>
<input type="range" name="totalRepeats" value=5 min=1 max=840 step=1 style="width:100%;" onChange="changeRepeats(this.value)">

<script> 
var myAudio=document.getElementById("audio1"); 
var myAudio2=document.getElementById("audio2"); 
var myAudio3=document.getElementById("audio3"); 
var myAudio4=document.getElementById("audio4"); 

totalRepeats = 5;
totalTime = 5;

function playAud()
  {   
  numRepeats = 1;
  elapsedTime = 0;

  myAudio.play(); 

  var startTime = new Date();
  var showStarttime = startTime.toLocaleTimeString();
  startMilliseconds = startTime.getTime();

  document.getElementById("startTime").innerHTML=showStarttime;

  document.getElementById("elapsedTime").innerHTML=formatTime(elapsedTime);

  document.getElementById("repeats").innerHTML=numRepeats;
 } 

function rptAud()
  { 
  myAudio.currentTime = 100; 
  myAudio2.currentTime = 100;
  myAudio3.currentTime = 100;
  myAudio4.currentTime = 100;
  } 

function stopAud()
  { 
  myAudio.pause();
  myAudio.currentTime = 0;
  myAudio2.pause();
  myAudio2.currentTime = 0;
  myAudio3.pause();
  myAudio3.currentTime = 0;
  myAudio4.pause();
  myAudio4.currentTime = 0;
  
  clearInterval(myVar);
  } 

function formatTime(totalTime) {
  h = Math.floor(totalTime / (60 * 60) );
  totalTime = totalTime % (60 * 60);
  m = Math.floor(totalTime / (60) );
  totalTime = totalTime % (60);
  s = Math.floor(totalTime);
  properTime = h + ":" + m + ":" + s;
  return properTime;
}
function changeRepeats(newPosition)
  { 
  totalRepeats = newPosition;
  document.getElementById("theTotalRepeats").innerHTML=totalRepeats;
  totalTime = totalRepeats * 105; 
  document.getElementById("theTotalTime").innerHTML=formatTime(totalTime);
 } 

var myVar=setInterval(function(){myTimer()},100);

function myTimer()
{
var d = new Date();
var t = d.toLocaleTimeString();
document.getElementById("currentTime").innerHTML=t;

Position = myAudio.currentTime.toFixed(0);
document.getElementById("position").innerHTML=formatTime(Position);

document.getElementById("repeats").innerHTML=numRepeats;

elapsedMilliseconds = d.getTime();
elapsedTime = (elapsedMilliseconds - startMilliseconds)/1000;
document.getElementById("elapsedTime").innerHTML=formatTime(elapsedTime);


if (myAudio.ended)
	{
	if (numRepeats < totalRepeats)
		{
		myAudio.currentTime = 0;
		myAudio.play();
		
		myAudioSrcNum = Math.floor((Math.random()*9)+1);
		
		switch (myAudioSrcNum)
		{
		case 1:
			myAudio2.src="./vexations-001.mp3";
		break;
		case 2:
			myAudio2.src="./vexations-002.mp3";
		break;
		case 3:
			myAudio2.src="./vexations-003.mp3";
		break;
		case 4:
			myAudio2.src="./vexations-004.mp3";
		break;
		case 5:
			myAudio2.src="./vexations-005.mp3";
		break;
		case 6:
			myAudio2.src="./vexations-006.mp3";
		break;
		case 7:
			myAudio2.src="./vexations-007.mp3";
		break;
		case 8:
			myAudio2.src="./vexations-008.mp3";
		break;
		case 9:
			myAudio2.src="";
		break;
		}
		
		myAudioSrcNum = Math.floor((Math.random()*9)+1);
		
		switch (myAudioSrcNum)
		{
		case 1:
			myAudio3.src="./vexations-001.mp3";
		break;
		case 2:
			myAudio3.src="./vexations-002.mp3";
		break;
		case 3:
			myAudio3.src="./vexations-003.mp3";
		break;
		case 4:
			myAudio3.src="./vexations-004.mp3";
		break;
		case 5:
			myAudio3.src="./vexations-005.mp3";
		break;
		case 6:
			myAudio3.src="./vexations-006.mp3";
		break;
		case 7:
			myAudio3.src="./vexations-007.mp3";
		break;
		case 8:
			myAudio3.src="./vexations-008.mp3";
		break;
		case 9:
			myAudio2.src="";
		break;
		}
		
		myAudioSrcNum = Math.floor((Math.random()*9)+1);
		
		switch (myAudioSrcNum)
		{
		case 1:
			myAudio4.src="./vexations-001.mp3";
		break;
		case 2:
			myAudio4.src="./vexations-002.mp3";
		break;
		case 3:
			myAudio4.src="./vexations-003.mp3";
		break;
		case 4:
			myAudio4.src="./vexations-004.mp3";
		break;
		case 5:
			myAudio4.src="./vexations-005.mp3";
		break;
		case 6:
			myAudio4.src="./vexations-006.mp3";
		break;
		case 7:
			myAudio4.src="./vexations-007.mp3";
		break;
		case 8:
			myAudio4.src="./vexations-008.mp3";
		break;
		case 9:
			myAudio2.src="";
		break;
		}
			myAudio2.play();
			myAudio3.play();
			myAudio4.play();
		
		numRepeats = numRepeats + 1;
		}
	}
}
</script> 
		<div>
	    Position: <strong><span id="position"></span></strong><br />
		</div>
	    <div>
		Repeat: <strong><span id="repeats"></span></strong><br />
	    </div>
	    <div>
		Current time: <strong><span id="currentTime"></span></strong><br />
	    </div>
	    <div>
		Start time: <strong><span id="startTime"></span></strong><br />
	    </div>
	    <div>
		Elapsed time: <strong><span id="elapsedTime"></strong></span>
	    </div>
		<div id="buttons">
		  <hr />
		  <div>
		  <input type="button" value="About this app" onClick="updateAbout()" />
          </div>
		</div>
     </div>
    </div>
    <!-- #main -->
    <!-- container -->
    <div id="footer-bar">
      <div class="container">
        <div class="sixteen columns">
          <footer id="colophon" role="contentinfo">
            <div id="footer">
              <p>In order to play the theme 840 times in succession, it would be advisable to prepare oneself beforehand, and in the deepest silence, by serious immobilities.</p>
			  <p><em>Pour se jouer 840 fois de suite ce motif, il sera bon de se preparer au prealable, et dans le plus grand silence, par des immobilites serieuses.</em></p>
            </div>
          </footer>
        </div>
        <!-- #colophon -->
      </div>
    </div>
	</div>
    <!-- #page -->
  </body>
</html>
